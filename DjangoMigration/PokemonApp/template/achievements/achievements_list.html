{% extends "base.html" %}
{% load static %}

{% block title %}<title>Succès</title>{% endblock %}

{% block content %}
<div class="container">
  <h1 class="mb-4">
    <i class="fas fa-trophy"></i> Succès
  </h1>
  
  <!-- Progression globale -->
  <div class="card mb-4">
    <div class="card-body">
      <h5>Progression Globale</h5>
      <div class="progress" style="height: 30px;">
        <div class="progress-bar bg-success" 
             role="progressbar" 
             style="width: '{{ completion_percent }}'%">
          {{ total_completed }} / {{ total_achievements }} ({{ completion_percent }}%)
        </div>
      </div>
    </div>
  </div>
  
  <!-- Achievements par catégorie -->
  {% for category, achievements in by_category.items %}
  <div class="card mb-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">
        {% if category == 'combat' %}<i class="fas fa-fist-raised"></i> Combat
        {% elif category == 'capture' %}<i class="fas fa-network-wired"></i> Capture
        {% elif category == 'collection' %}<i class="fas fa-book"></i> Collection
        {% elif category == 'exploration' %}<i class="fas fa-map"></i> Exploration
        {% elif category == 'progression' %}<i class="fas fa-trophy"></i> Progression
        {% endif %}
      </h4>
    </div>
    
    <div class="card-body">
      <div class="row">
        {% for data in achievements %}
        <div class="col-md-6 mb-3">
          <div class="achievement-card {% if data.completed %}achievement-completed{% endif %}">
            <div class="d-flex align-items-center">
              <div class="achievement-icon">
                {% if data.completed %}
                <i class="fas fa-trophy text-warning fa-3x"></i>
                {% else %}
                <i class="fas fa-lock text-muted fa-3x"></i>
                {% endif %}
              </div>
              
              <div class="flex-grow-1 ml-3">
                <h6 class="mb-1">{{ data.achievement.name }}</h6>
                <p class="text-muted small mb-2">{{ data.achievement.description }}</p>
                
                <!-- Progress bar -->
                <div class="progress mb-2" style="height: 20px;">
                  <div class="progress-bar {% if data.completed %}bg-success{% else %}bg-info{% endif %}" 
                       style="width: '{{ data.progress_percent }}'%">
                    {{ data.current }} / {{ data.required }}
                  </div>
                </div>
                
                <!-- Récompense -->
                <small class="text-muted">
                  <i class="fas fa-gift"></i> 
                  {{ data.achievement.reward_money }}₽
                  {% if data.achievement.reward_item %}
                  + {{ data.achievement.reward_item.name }}
                  {% endif %}
                </small>
                
                {% if data.completed %}
                <p class="text-success small mb-0 mt-1">
                  <i class="fas fa-check"></i> Complété {{ data.completed_at|timesince }} ago
                </p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<style>
.achievement-card {
  border: 2px solid #ddd;
  border-radius: 10px;
  padding: 15px;
  transition: all 0.3s ease;
}

.achievement-card:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transform: translateY(-2px);
}

.achievement-completed {
  border-color: #28a745;
  background-color: #f0fff0;
}

.achievement-icon {
  width: 60px;
  text-align: center;
}
</style>
{% endblock %}